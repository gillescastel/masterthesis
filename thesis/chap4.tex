\chapter{Applications of Morse homology}
\label{chap:app-morse-homology}


\todo{Now  that we know it's isomorphic, we have some nice theorems: 
    \begin{itemize}
        \item Poincare duality
        \item Mayer-Vietoris
        \item Kunneth
        \item Excision theorem (?)
        \item Hurewicz theorem (?)
        \item Universal coefficient theorem (?)
    \end{itemize}
But it can be nice to see this directly in Morse theory}



\section{Morse inequalities}
\subsection{Morse inequalities over $\Z_2$}

The Morse inequalities state that there is a lower bound on the number of critical points, which only depends on the homology of the manifold:
\begin{theorem}[Weak Morse inequalities]
    Let $f: M \to  \R$ a Morse function. Then
    \[
        \# \Crit f \ge \sum \dim \HMf[k]{M, \Z_2}
    ,\] 
    and more specifically,
    \[
        \# \Crit_k f \ge \dim \HMf[k]{M, \Z_2}
    .\] 
\end{theorem}
\begin{proof}
    This is actually a very straightforward result, following from the fact that \[
    \HMf[k]{M, \Z_2} = \frac{\Ker \partial_k}{\Im \partial_{k-1}},
    \] so $\dim \HMf[k]{M, \Z_2} = \dim \frac{\Ker \partial_k}{\Im \partial_{k-1}} \le  \dim C_k = \# \Crit_k f$.
\end{proof}

A result in similar vein is the following:
\begin{theorem}
    Let $f: M \to  \R$ be a Morse function. Then
    \[
        \sum (-1)^{k} \# \Crit_k f = \sum (-1)^{k} \dim \HMf[k]{M, \Z_2}  = \chi(M)
    .\] 
    Considering this equality modulo $2$, we get
    \[
        \# \Crit f  \equiv \sum \dim \HMf[k]{M, \Z_2} \mod 2
    .\] 
\end{theorem}
\begin{remark}
    This alternating sum is a generalization of the Euler characteristic of a manifold, defined to be
    \[
    \chi(M) = \sum (-1)^{k} \dim H_k(M, \Z_2)
    .\] 

    In the case of polyhedra, this equation reduces to $2 = V - E + F$, where $V$, $E$ and  $F$ are the number of vertices, edges and faces in the polyhedron.
\end{remark}
% \todo{Mention the definition of $\chi(M) = \sum (-1)^{k} H_k$  and moreover that it doesn't depend on the field/ring we are working over!}
\begin{marginfigure}
    \centering
    \incfig{linear-map-rank-nullity-theorem}
    \caption{Visual depiction of the rank-nullity theorem stating that $\dim \Im T + \dim \Ker T = \dim V$.}
    \label{fig:linear-map-rank-nullity-theorem}
\end{marginfigure}

\begin{marginfigure}
    \centering
    \incfig{morse-chain-complex-visualized}
    \caption{
        Top: same illustration as above, this time for the Morse complex with its differential.
        Each orange lines corresponds to a homology group.
        Bottom: The alternating sum of the dimensions of $C_k$ equals the alternating sum of the dimensions of $H_k$.
    }
    \label{fig:morse-chain-complex-visualized}
\end{marginfigure}
\begin{marginfigure}
    \centering
    \incfig{morse-chain-complex-visualized-truncated}
    \caption{Truncating the above picture, we find that the alternating sum of the dimensions of $C_k$ is greater than the alternating sum of the dimensions of  $H_k$. All the thick black lines cancel, exert the one circled, giving rise to the inequality.
    }
    \label{fig:morse-chain-complex-visualized-truncated}
\end{marginfigure}
\begin{proof}
    Use the fact that 
    \[
        \HMf[k]{M, \Z_2} = \frac{\Ker \partial_k}{\Im \partial_{k-1}} \qquad \# \Crit_k f = \dim C_k,
    \]
    together with rank-nullity theorem for vector spaces (we are working over $\Z_2$). A computation completes the proof.

    To represent this proof more visually, have a look at Figure~\ref{fig:linear-map-rank-nullity-theorem}, expressing the rank-nullity theorem, which in this context says that the two slanted lines are parallel, implying that $\dim V - \dim \Ker T = \dim \Im T$.
    Repeating this diagram for $\partial_k$, remembering that  $\partial_k^2 = 0$, gives Figure~\ref{fig:morse-chain-complex-visualized} (top). We have highlighted the dimension of the homology spaces in orange, and we have indicated spaces of the same dimensions with the same type of black thick lines.
    The bottom part of Figure~\ref{fig:morse-chain-complex-visualized} shows that when we consider the alternating sum of the dimensions of $C_k$, the thick black lines cancel, leaving us with the alternating sum of the dimensions of $H_k$.
    \end{proof}

    We can also truncate this argument, considering only a partial alternating sum, illustrated in Figure~\ref{fig:morse-chain-complex-visualized-truncated}.
    In this case, we do not have equality (the reason has been indicated in the figure), but we do have the following result:
\begin{theorem}[Strong Morse inequalities]
    For any Morse function $f: M \to  \R$ and for any $m = 0, \ldots, n$, the following inequality holds:
    \[
        \sum_{k=0}^{m} (-1)^{k+m} \# \Crit_k f \ge  \sum_{k=0}^{m} (-1)^{k+m} \dim \HMf[k]{M, \Z_2}
    .\] 
\end{theorem}

It is easy to check that the strong Morse inequalities are in fact stronger:the weak version can be obtained by by subtracting the strong inequalities for $m$ and  $m+1$.



\begin{eg}
    TODO example and say what this means.
\end{eg}

\subsection{Morse inequalities over $\Z$ and $\Z_p$}

A natural question that arises when discussing these inequalities is: `Can we get stronger inequalities if we work over a different ring?' and `Can we find a Morse function $f$ that attains these inequalities?'

For the first question, let us first have a look at how we can generalize the Morse inequalities to $\Z$ and $\Z_p$.
Both of these options have their own difficulties.

When working over $\Z$, the dimension of a $\Z$-module is not well defined, so we need to introduce new notions such as rank and torsion rank to replace the notion of dimension. Moreover, the rank-nullity theorem used in the proof is not obvious.

For $\Z_p$, the difficulties lie on the other side of the inequality: how do we define Morse homology over $\Z_p$ for an arbitrary prime $p$?
The answer to this question is that---just like in the case of $\Z$---we should take orientation into account and then everything works out.
Also the proof of the Morse inequalities works out, because we are working over $\Z_p$ which is a field. We therefore have the following results:

\begin{theorem}
    The (weak and strong) Morse inequalities hold over $\Z_p$ for any prime $p$.
\end{theorem}
\begin{proof}
    Exactly the same as before. As modules over $\Z_p$ are vector spaces, nothing changes.
\end{proof}

Let us now discuss the case for $\Z$.
While we cannot define dimension, we can define different notions of ranks. Following `Infinite Abelian Groups' by Fuchs\sidecite{fuchs1970infinite}, we define the following invariants:
\begin{definition}[Rank]
    Let $A$ be a  $\Z$-module. Then the following notions of rank are invariants of $A$:
    \begin{align*}
        r_0(A) &:= \parbox[t]{6.2cm}{cardinality of a maximal set of independent elements of infinite order}\\[0.3em]
            &= \dim_{\Q} A \otimes \Q\\
        r_p(A) &:= \parbox[t]{6.2cm}{cardinality of a maximal set of independent elements of order $p^{k}$ for some $k$}\\[0.3em]
        r_t(A) &:= \sum_{p} r_p(A)\\[0.3em]
        r(A) &:= r_0(A) + \sum_{p}r_p(A)
    .\end{align*}
\end{definition}
\begin{eg}
    Let $A = \Z^2 \oplus \Z_4 \oplus \Z_3 \oplus \Z_2$.
    Then
    \[
        r_0(A) = 2 \qquad
        r_2(A) = 2 \qquad
        r_3(A) = 1 \qquad
    ,\] 
    and therefore the torsion rank is $r_t(A) = 3$ and the total rank is $r(A) = 5$.
\end{eg}
We also have the following proposition\sidecite[p. 86]{fuchs1970infinite}
\begin{lemma}
    Let $A$ and $B$ be $\Z$ modules and suppose $A$ is  a submodule of $B$.
    Then
    \begin{enumerate}[(i)]
        \item $r(B) \le  r(A)$
        \item $r(A) \le  r(B) + r(A / B)$
        \item $r(A) < r(A / B)$ can happen
        \item  $ r_0(A) = r_0(B) + r_0(A/B)$ \label{label:zmodules-last}
    \end{enumerate}
\end{lemma}

Note in particular identity~\ref{label:zmodules-last}, which is a rank-nullity theorem in the context of the $r_0$ rank.
Also note that the modules $C_k(f, \Z)$ over $\Z$ with as generators the critical points of $f$, are free, so $\# \Crit_k f =r_0(C_k(f, \Z))$.
These two facts combined give the following result:
\begin{prop}
    The (weak and strong) Morse inequalities hold over $\Z$, in the following sense:
    \[
        \# \Crit_k f \ge  r_0(\HMf[k]{M, \Z})
    ,\] 
    and for any $m = 0, \ldots, n$ we have
        \[
            \sum_{k=0}^{m} (-1)^{k+m} \# \Crit_k f \ge  \sum_{k=0}^{m} (-1)^{k+m} r_0(\HMf[k]{M, \Z})
        .\] 
\end{prop}
\begin{proof}
    Similar as before, replacing $\Z_2$ by $\Z$ and $\dim$ by $r_0$.
\end{proof}

\subsection{Comparing the Morse inequalities over $\Z$ and $\Z_p$}

An interesting question is `Are the different version of the Morse inequalities equally strong?'
The following example shows that this is not the case:

\begin{eg}
    Consider the Klein bottle $K$.
    Remember that its homology over $\Z$ is given by $(\Z, \Z_2 \oplus \Z, 0)$ and over $ \Z_2$ by $(\Z_2, \Z_2^2, \Z_2)$.
    Therefore, the weak Morse inequalities over $\Z$ give
    \[
    C_0 \ge 1 \qquad C_1 \ge 1 \qquad C_2 \ge 0
    ,\] 
    and those over $\Z_2$ give
    \[
    C_0 \ge  1 \qquad C_1 \ge  2 \qquad C_2 \ge  1
    ,\] 
    which are clearly stronger.
    This is still the case when we consider the strong Morse equalities. Over $ \Z$ we have
    \[
    C_0 \ge  1 \qquad C_1 - C_0 \ge  0 \qquad C_2 - C_1 + C_0 \ge  0
    ,\] 
    while over $\Z_2$ we get
    \[
    C_0 \ge  1 \qquad C_1 - C_0 \ge  1 \qquad C_2 - C_1 + C_0 \ge  0
    .\] 
\end{eg}

\begin{remark}
    The Morse equalities are strict when $M$ is closed and simply connected $n\ge 6$, meaning that there always exists a Morse function $f: M \to  \R$ such that $\# \Crit_k f = \dim \HMf[k]f$. This is called Smale's theorem \sidecite[p.~392]{smale2007generalized}, and we will prove \todo{REFER}
\end{remark}

\todo{Talk about Morse inequalities with torsion! Pitchers equalities}




\section{The Künneth Formula}
The Künneth Formula is a way to relate the homology of a product to the homology of its factors and it states the following:
\begin{prop}[Künneth formula]
    Let $M, N$ be two manifolds. Then
    \[
        \HMf[k]{M \times N} \cong
        \bigoplus_{i+j  = k} \HMf[i]{M} \otimes \HMf[j]{N}
    ,\] 
where homology is taken with coefficients in $ \Z_2$.
\end{prop}
We can also express this in a different way using the Poincaré polynomial.
For this, define $\beta_k(M) = \dim_{\Z_2} \HMf[k]{M;\Z_2}$, the $k$th Betti number and let $P_M(t) = \sum_k \beta_k(M) ^{k}$.
Then the Künneth formula tells us that $P_{M \times N}(t) = P_M(t) P_N(t)$.
\begin{eg}
    We have $P_{S^{1}}(t) = 1 + t$, so $P_{S^{1}\times S^{1}\times S^{1}} = (1 + t)^3 = 1 + 3t + 3t^2 + 1t^3$, exactly the result we found in Example~\ref{eg:homology-of-the-three-torus}.
    More in general, we have that $\beta_k(T^{n})$ is the $k$th coefficient of $(1+t)^{n}$, i.e.\ $\binom{n}{k}$.
\end{eg}
\begin{proof}
    Let $f, g$ and $X, Y$ be two Morse functions, resp.\ pseudo-gradient fields on  $M$ and  $N$.
    Then $f + g$ is a Morse function and $(X, Y)$ is a pseudo-gradient field. If we assume that $X$ and  $Y$ satisfies the Smale condition, then so does $(X,Y)$.
    Critical points of $f+g$ are pairs of critical points of $f$ and $g$ and their indices are sums of the original indices. 
    Furthermore, trajectories of $(X, Y)$ correspond exactly to pairs of trajectories of $X$ and $Y$.
    Now, in order to understand the differential $\partial_{(X, Y)}$ on $M \times N$, we are interested in gradient flow lines that connect critical points $(a,b)$ and  $(c,d)$ whose index differ by exactly one.
    It's clear that the only way this can happen is when $a = c$ or $b = d$.\sidenote{
        If $a\neq c$ and  $b \neq d$, then  $\Ind c \ge  \Ind a + 1$ and $\Ind d \ge  \Ind b + 1$, so $\Ind (c, d) \ge  \Ind (a, b) + 2$.
    }

    When we think about this in terms of directed graphs of critical points, like we did in the example of $T^{3}$, we find that the graph of $M \times N$ is the Cartesian product of the graph of $M$ and the graph of  $N$.
    With these things in mind, it is easy to check that
    \begin{align*}
        \Phi: \bigoplus_{i+j = k} C_i(f) \otimes C_j(g) &\longrightarrow C_k(f+g) \\
        a \otimes b &\longmapsto (a,b)
    \end{align*}
    is an isomorphism of complexes with the following differentials:
    \[
        (C_\bul(f) \otimes C_\bul(g), \partial_X \otimes 1 + 1 \otimes \partial_Y) \xrightarrow{\Phi}   (C_\bul(f+g), \partial_{(X,Y)})
    ,\] 
    where $(C_\bul(f) \otimes C_\bul(g))_k := \bigoplus_{i+j = k} C_i(f) \otimes C_j(g)$.
    Now, taking the homology of both sides, and remembering that the homology of the tensor product complex is the tensor product of the homologies (Proposition~\ref{prop:hom-tensor-is-tensor-hom}), we get exactly what we want:
    \[
        \bigoplus_{i+j = k} \HMf[i]{M; \Z_2} \otimes \HMf[j]{N; \Z_2} \cong \HMf[k]{M \times N; \Z_2}
    .\] 
    Note that we take the homology with coefficients in $\Z_2$ in order to satisfy the conditions of Proposition~\ref{prop:hom-tensor-is-tensor-hom}.
\begin{marginfigure}
    \centering
    \incfig{kunneth-formula}
    \caption{TODO kunneth formula}
    \label{fig:kunneth-formula}
\end{marginfigure}
\end{proof}

\section{Poincaré duality}
\todo{maybe follow shintaro?}

\begin{theorem}
    Let $M$ be an orientable cobordism from  $M_0$ to $M_1$.
    Then
    \[
        H_k(M, M_1, \Z) \cong H^{n-k}(M,M_0, \Z) \qquad k = 0, \ldots, n
    .\] 
    Over $\Z_2$, this results in
    \[
        H_k(M, M_1, \Z_2) \cong H_{n-k}(M,M_0, \Z_2) \qquad k = 0, \ldots, n
    .\] 
\end{theorem}
\todo{also on cobordisms (antonio p.136)}
